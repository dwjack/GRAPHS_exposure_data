#
# This is the user-interface definition of a Shiny web application. You can
# run the application by clicking 'Run App' above.
#
# Find out more about building applications with Shiny here:
# 
#    http://shiny.rstudio.com/
#

library(shiny)

# # Define UI for application that draws a histogram
# shinyUI(fluidPage(
#   
#   # Application title
#   titlePanel("Old Faithful Geyser Data"),
#   
#   # Sidebar with a slider input for number of bins 
#   sidebarLayout(
#     sidebarPanel(
#        sliderInput("bins",
#                    "Number of bins:",
#                    min = 1,
#                    max = 50,
#                    value = 30)
#     ),
#     
#     # Show a plot of the generated distribution
#     mainPanel(
#        plotOutput("distPlot")
#     )
#   )
# ))

shinyUI(pageWithSidebar(
  
  headerPanel("MicroPEM (PM Monitor) Data Analysis"),
  
  sidebarPanel(
    #  textInput("permID", "What is the Permanent ID?", "PermanentID"),
    
    textInput("subject", "What is the Study ID?", "StudyID"),
    
    textInput("session", "Which Monitoring Session is this? (1-10)", "Session"),
    
    textInput("filter", "What is the Filter ID?", "Filter"),
    
    selectInput("timezone", "What is the Timezone?", list("Africa/Abidjan",
                                                          "Africa/Accra",
                                                          "Africa/Addis_Ababa",
                                                          "Africa/Algiers",
                                                          "Africa/Asmara",
                                                          "Africa/Asmera",
                                                          "Africa/Bamako",
                                                          "Africa/Bangui",
                                                          "Africa/Banjul",
                                                          "Africa/Bissau",
                                                          "Africa/Blantyre",
                                                          "Africa/Brazzaville",
                                                          "Africa/Bujumbura",
                                                          "Africa/Cairo",
                                                          "Africa/Casablanca",
                                                          "Africa/Ceuta",
                                                          "Africa/Conakry",
                                                          "Africa/Dakar",
                                                          "Africa/Dar_es_Salaam",
                                                          "Africa/Djibouti",
                                                          "Africa/Douala",
                                                          "Africa/El_Aaiun",
                                                          "Africa/Freetown",
                                                          "Africa/Gaborone",
                                                          "Africa/Harare",
                                                          "Africa/Johannesburg",
                                                          "Africa/Juba",
                                                          "Africa/Kampala",
                                                          "Africa/Khartoum",
                                                          "Africa/Kigali",
                                                          "Africa/Kinshasa",
                                                          "Africa/Lagos",
                                                          "Africa/Libreville",
                                                          "Africa/Lome",
                                                          "Africa/Luanda",
                                                          "Africa/Lubumbashi",
                                                          "Africa/Lusaka",
                                                          "Africa/Malabo",
                                                          "Africa/Maputo",
                                                          "Africa/Maseru",
                                                          "Africa/Mbabane",
                                                          "Africa/Mogadishu",
                                                          "Africa/Monrovia",
                                                          "Africa/Nairobi",
                                                          "Africa/Ndjamena",
                                                          "Africa/Niamey",
                                                          "Africa/Nouakchott",
                                                          "Africa/Ouagadougou",
                                                          "Africa/Porto-Novo",
                                                          "Africa/Sao_Tome",
                                                          "Africa/Timbuktu",
                                                          "Africa/Tripoli",
                                                          "Africa/Tunis",
                                                          "Africa/Windhoek",
                                                          "AKST9AKDT",
                                                          "America/Adak",
                                                          "America/Anchorage",
                                                          "America/Anguilla",
                                                          "America/Antigua",
                                                          "America/Araguaina",
                                                          "America/Argentina/Buenos_Aires",
                                                          "America/Argentina/Catamarca",
                                                          "America/Argentina/ComodRivadavia",
                                                          "America/Argentina/Cordoba",
                                                          "America/Argentina/Jujuy",
                                                          "America/Argentina/La_Rioja",
                                                          "America/Argentina/Mendoza",
                                                          "America/Argentina/Rio_Gallegos",
                                                          "America/Argentina/Salta",
                                                          "America/Argentina/San_Juan",
                                                          "America/Argentina/San_Luis",
                                                          "America/Argentina/Tucuman",
                                                          "America/Argentina/Ushuaia",
                                                          "America/Aruba",
                                                          "America/Asuncion",
                                                          "America/Atikokan",
                                                          "America/Atka",
                                                          "America/Bahia",
                                                          "America/Bahia_Banderas",
                                                          "America/Barbados",
                                                          "America/Belem",
                                                          "America/Belize",
                                                          "America/Blanc-Sablon",
                                                          "America/Boa_Vista",
                                                          "America/Bogota",
                                                          "America/Boise",
                                                          "America/Buenos_Aires",
                                                          "America/Cambridge_Bay",
                                                          "America/Campo_Grande",
                                                          "America/Cancun",
                                                          "America/Caracas",
                                                          "America/Catamarca",
                                                          "America/Cayenne",
                                                          "America/Cayman",
                                                          "America/Chicago",
                                                          "America/Chihuahua",
                                                          "America/Coral_Harbour",
                                                          "America/Cordoba",
                                                          "America/Costa_Rica",
                                                          "America/Creston",
                                                          "America/Cuiaba",
                                                          "America/Curacao",
                                                          "America/Danmarkshavn",
                                                          "America/Dawson",
                                                          "America/Dawson_Creek",
                                                          "America/Denver",
                                                          "America/Detroit",
                                                          "America/Dominica",
                                                          "America/Edmonton",
                                                          "America/Eirunepe",
                                                          "America/El_Salvador",
                                                          "America/Ensenada",
                                                          "America/Fort_Wayne",
                                                          "America/Fortaleza",
                                                          "America/Glace_Bay",
                                                          "America/Godthab",
                                                          "America/Goose_Bay",
                                                          "America/Grand_Turk",
                                                          "America/Grenada",
                                                          "America/Guadeloupe",
                                                          "America/Guatemala",
                                                          "America/Guayaquil",
                                                          "America/Guyana",
                                                          "America/Halifax",
                                                          "America/Havana",
                                                          "America/Hermosillo",
                                                          "America/Indiana/Indianapolis",
                                                          "America/Indiana/Knox",
                                                          "America/Indiana/Marengo",
                                                          "America/Indiana/Petersburg",
                                                          "America/Indiana/Tell_City",
                                                          "America/Indiana/Vevay",
                                                          "America/Indiana/Vincennes",
                                                          "America/Indiana/Winamac",
                                                          "America/Indianapolis",
                                                          "America/Inuvik",
                                                          "America/Iqaluit",
                                                          "America/Jamaica",
                                                          "America/Jujuy",
                                                          "America/Juneau",
                                                          "America/Kentucky/Louisville",
                                                          "America/Kentucky/Monticello",
                                                          "America/Knox_IN",
                                                          "America/Kralendijk",
                                                          "America/La_Paz",
                                                          "America/Lima",
                                                          "America/Los_Angeles",
                                                          "America/Louisville",
                                                          "America/Lower_Princes",
                                                          "America/Maceio",
                                                          "America/Managua",
                                                          "America/Manaus",
                                                          "America/Marigot",
                                                          "America/Martinique",
                                                          "America/Matamoros",
                                                          "America/Mazatlan",
                                                          "America/Mendoza",
                                                          "America/Menominee",
                                                          "America/Merida",
                                                          "America/Metlakatla",
                                                          "America/Mexico_City",
                                                          "America/Miquelon",
                                                          "America/Moncton",
                                                          "America/Monterrey",
                                                          "America/Montevideo",
                                                          "America/Montreal",
                                                          "America/Montserrat",
                                                          "America/Nassau",
                                                          "America/New_York",
                                                          "America/Nipigon",
                                                          "America/Nome",
                                                          "America/Noronha",
                                                          "America/North_Dakota/Beulah",
                                                          "America/North_Dakota/Center",
                                                          "America/North_Dakota/New_Salem",
                                                          "America/Ojinaga",
                                                          "America/Panama",
                                                          "America/Pangnirtung",
                                                          "America/Paramaribo",
                                                          "America/Phoenix",
                                                          "America/Port_of_Spain",
                                                          "America/Port-au-Prince",
                                                          "America/Porto_Acre",
                                                          "America/Porto_Velho",
                                                          "America/Puerto_Rico",
                                                          "America/Rainy_River",
                                                          "America/Rankin_Inlet",
                                                          "America/Recife",
                                                          "America/Regina",
                                                          "America/Resolute",
                                                          "America/Rio_Branco",
                                                          "America/Rosario",
                                                          "America/Santa_Isabel",
                                                          "America/Santarem",
                                                          "America/Santiago",
                                                          "America/Santo_Domingo",
                                                          "America/Sao_Paulo",
                                                          "America/Scoresbysund",
                                                          "America/Shiprock",
                                                          "America/Sitka",
                                                          "America/St_Barthelemy",
                                                          "America/St_Johns",
                                                          "America/St_Kitts",
                                                          "America/St_Lucia",
                                                          "America/St_Thomas",
                                                          "America/St_Vincent",
                                                          "America/Swift_Current",
                                                          "America/Tegucigalpa",
                                                          "America/Thule",
                                                          "America/Thunder_Bay",
                                                          "America/Tijuana",
                                                          "America/Toronto",
                                                          "America/Tortola",
                                                          "America/Vancouver",
                                                          "America/Virgin",
                                                          "America/Whitehorse",
                                                          "America/Winnipeg",
                                                          "America/Yakutat",
                                                          "America/Yellowknife",
                                                          "Antarctica/Casey",
                                                          "Antarctica/Davis",
                                                          "Antarctica/DumontDUrville",
                                                          "Antarctica/Macquarie",
                                                          "Antarctica/Mawson",
                                                          "Antarctica/McMurdo",
                                                          "Antarctica/Palmer",
                                                          "Antarctica/Rothera",
                                                          "Antarctica/South_Pole",
                                                          "Antarctica/Syowa",
                                                          "Antarctica/Vostok",
                                                          "Arctic/Longyearbyen",
                                                          "Asia/Aden",
                                                          "Asia/Almaty",
                                                          "Asia/Amman",
                                                          "Asia/Anadyr",
                                                          "Asia/Aqtau",
                                                          "Asia/Aqtobe",
                                                          "Asia/Ashgabat",
                                                          "Asia/Ashkhabad",
                                                          "Asia/Baghdad",
                                                          "Asia/Bahrain",
                                                          "Asia/Baku",
                                                          "Asia/Bangkok",
                                                          "Asia/Beirut",
                                                          "Asia/Bishkek",
                                                          "Asia/Brunei",
                                                          "Asia/Calcutta",
                                                          "Asia/Choibalsan",
                                                          "Asia/Chongqing",
                                                          "Asia/Chungking",
                                                          "Asia/Colombo",
                                                          "Asia/Dacca",
                                                          "Asia/Damascus",
                                                          "Asia/Dhaka",
                                                          "Asia/Dili",
                                                          "Asia/Dubai",
                                                          "Asia/Dushanbe",
                                                          "Asia/Gaza",
                                                          "Asia/Harbin",
                                                          "Asia/Hebron",
                                                          "Asia/Ho_Chi_Minh",
                                                          "Asia/Hong_Kong",
                                                          "Asia/Hovd",
                                                          "Asia/Irkutsk",
                                                          "Asia/Istanbul",
                                                          "Asia/Jakarta",
                                                          "Asia/Jayapura",
                                                          "Asia/Jerusalem",
                                                          "Asia/Kabul",
                                                          "Asia/Kamchatka",
                                                          "Asia/Karachi",
                                                          "Asia/Kashgar",
                                                          "Asia/Kathmandu",
                                                          "Asia/Katmandu",
                                                          "Asia/Kolkata",
                                                          "Asia/Krasnoyarsk",
                                                          "Asia/Kuala_Lumpur",
                                                          "Asia/Kuching",
                                                          "Asia/Kuwait",
                                                          "Asia/Macao",
                                                          "Asia/Macau",
                                                          "Asia/Magadan",
                                                          "Asia/Makassar",
                                                          "Asia/Manila",
                                                          "Asia/Muscat",
                                                          "Asia/Nicosia",
                                                          "Asia/Novokuznetsk",
                                                          "Asia/Novosibirsk",
                                                          "Asia/Omsk",
                                                          "Asia/Oral",
                                                          "Asia/Phnom_Penh",
                                                          "Asia/Pontianak",
                                                          "Asia/Pyongyang",
                                                          "Asia/Qatar",
                                                          "Asia/Qyzylorda",
                                                          "Asia/Rangoon",
                                                          "Asia/Riyadh",
                                                          "Asia/Saigon",
                                                          "Asia/Sakhalin",
                                                          "Asia/Samarkand",
                                                          "Asia/Seoul",
                                                          "Asia/Shanghai",
                                                          "Asia/Singapore",
                                                          "Asia/Taipei",
                                                          "Asia/Tashkent",
                                                          "Asia/Tbilisi",
                                                          "Asia/Tehran",
                                                          "Asia/Tel_Aviv",
                                                          "Asia/Thimbu",
                                                          "Asia/Thimphu",
                                                          "Asia/Tokyo",
                                                          "Asia/Ujung_Pandang",
                                                          "Asia/Ulaanbaatar",
                                                          "Asia/Ulan_Bator",
                                                          "Asia/Urumqi",
                                                          "Asia/Vientiane",
                                                          "Asia/Vladivostok",
                                                          "Asia/Yakutsk",
                                                          "Asia/Yekaterinburg",
                                                          "Asia/Yerevan",
                                                          "Atlantic/Azores",
                                                          "Atlantic/Bermuda",
                                                          "Atlantic/Canary",
                                                          "Atlantic/Cape_Verde",
                                                          "Atlantic/Faeroe",
                                                          "Atlantic/Faroe",
                                                          "Atlantic/Jan_Mayen",
                                                          "Atlantic/Madeira",
                                                          "Atlantic/Reykjavik",
                                                          "Atlantic/South_Georgia",
                                                          "Atlantic/St_Helena",
                                                          "Atlantic/Stanley",
                                                          "Australia/ACT",
                                                          "Australia/Adelaide",
                                                          "Australia/Brisbane",
                                                          "Australia/Broken_Hill",
                                                          "Australia/Canberra",
                                                          "Australia/Currie",
                                                          "Australia/Darwin",
                                                          "Australia/Eucla",
                                                          "Australia/Hobart",
                                                          "Australia/LHI",
                                                          "Australia/Lindeman",
                                                          "Australia/Lord_Howe",
                                                          "Australia/Melbourne",
                                                          "Australia/North",
                                                          "Australia/NSW",
                                                          "Australia/Perth",
                                                          "Australia/Queensland",
                                                          "Australia/South",
                                                          "Australia/Sydney",
                                                          "Australia/Tasmania",
                                                          "Australia/Victoria",
                                                          "Australia/West",
                                                          "Australia/Yancowinna",
                                                          "Brazil/Acre",
                                                          "Brazil/DeNoronha",
                                                          "Brazil/East",
                                                          "Brazil/West",
                                                          "Canada/Atlantic",
                                                          "Canada/Central",
                                                          "Canada/Eastern",
                                                          "Canada/East-Saskatchewan",
                                                          "Canada/Mountain",
                                                          "Canada/Newfoundland",
                                                          "Canada/Pacific",
                                                          "Canada/Saskatchewan",
                                                          "Canada/Yukon",
                                                          "CET",
                                                          "Chile/Continental",
                                                          "Chile/EasterIsland",
                                                          "CST6CDT",
                                                          "Cuba",
                                                          "EET",
                                                          "Egypt",
                                                          "Eire",
                                                          "EST",
                                                          "EST5EDT",
                                                          "Etc./GMT",
                                                          "Etc./GMT+0",
                                                          "Etc./UCT",
                                                          "Etc./Universal",
                                                          "Etc./UTC",
                                                          "Etc./Zulu",
                                                          "Europe/Amsterdam",
                                                          "Europe/Andorra",
                                                          "Europe/Athens",
                                                          "Europe/Belfast",
                                                          "Europe/Belgrade",
                                                          "Europe/Berlin",
                                                          "Europe/Bratislava",
                                                          "Europe/Brussels",
                                                          "Europe/Bucharest",
                                                          "Europe/Budapest",
                                                          "Europe/Chisinau",
                                                          "Europe/Copenhagen",
                                                          "Europe/Dublin",
                                                          "Europe/Gibraltar",
                                                          "Europe/Guernsey",
                                                          "Europe/Helsinki",
                                                          "Europe/Isle_of_Man",
                                                          "Europe/Istanbul",
                                                          "Europe/Jersey",
                                                          "Europe/Kaliningrad",
                                                          "Europe/Kiev",
                                                          "Europe/Lisbon",
                                                          "Europe/Ljubljana",
                                                          "Europe/London",
                                                          "Europe/Luxembourg",
                                                          "Europe/Madrid",
                                                          "Europe/Malta",
                                                          "Europe/Mariehamn",
                                                          "Europe/Minsk",
                                                          "Europe/Monaco",
                                                          "Europe/Moscow",
                                                          "Europe/Nicosia",
                                                          "Europe/Oslo",
                                                          "Europe/Paris",
                                                          "Europe/Podgorica",
                                                          "Europe/Prague",
                                                          "Europe/Riga",
                                                          "Europe/Rome",
                                                          "Europe/Samara",
                                                          "Europe/San_Marino",
                                                          "Europe/Sarajevo",
                                                          "Europe/Simferopol",
                                                          "Europe/Skopje",
                                                          "Europe/Sofia",
                                                          "Europe/Stockholm",
                                                          "Europe/Tallinn",
                                                          "Europe/Tirane",
                                                          "Europe/Tiraspol",
                                                          "Europe/Uzhgorod",
                                                          "Europe/Vaduz",
                                                          "Europe/Vatican",
                                                          "Europe/Vienna",
                                                          "Europe/Vilnius",
                                                          "Europe/Volgograd",
                                                          "Europe/Warsaw",
                                                          "Europe/Zagreb",
                                                          "Europe/Zaporozhye",
                                                          "Europe/Zurich",
                                                          "GB",
                                                          "GB-Eire",
                                                          "GMT",
                                                          "GMT+0",
                                                          "GMT0",
                                                          "GMT-0",
                                                          "Greenwich",
                                                          "Hong Kong",
                                                          "HST",
                                                          "Iceland",
                                                          "Indian/Antananarivo",
                                                          "Indian/Chagos",
                                                          "Indian/Christmas",
                                                          "Indian/Cocos",
                                                          "Indian/Comoro",
                                                          "Indian/Kerguelen",
                                                          "Indian/Mahe",
                                                          "Indian/Maldives",
                                                          "Indian/Mauritius",
                                                          "Indian/Mayotte",
                                                          "Indian/Reunion",
                                                          "Iran",
                                                          "Israel",
                                                          "Jamaica",
                                                          "Japan",
                                                          "JST-9",
                                                          "Kwajalein",
                                                          "Libya",
                                                          "MET",
                                                          "Mexico/BajaNorte",
                                                          "Mexico/BajaSur",
                                                          "Mexico/General",
                                                          "MST",
                                                          "MST7MDT",
                                                          "Navajo",
                                                          "NZ",
                                                          "NZ-CHAT",
                                                          "Pacific/Apia",
                                                          "Pacific/Auckland",
                                                          "Pacific/Chatham",
                                                          "Pacific/Chuuk",
                                                          "Pacific/Easter",
                                                          "Pacific/Efate",
                                                          "Pacific/Enderbury",
                                                          "Pacific/Fakaofo",
                                                          "Pacific/Fiji",
                                                          "Pacific/Funafuti",
                                                          "Pacific/Galapagos",
                                                          "Pacific/Gambier",
                                                          "Pacific/Guadalcanal",
                                                          "Pacific/Guam",
                                                          "Pacific/Honolulu",
                                                          "Pacific/Johnston",
                                                          "Pacific/Kiritimati",
                                                          "Pacific/Kosrae",
                                                          "Pacific/Kwajalein",
                                                          "Pacific/Majuro",
                                                          "Pacific/Marquesas",
                                                          "Pacific/Midway",
                                                          "Pacific/Nauru",
                                                          "Pacific/Niue",
                                                          "Pacific/Norfolk",
                                                          "Pacific/Noumea",
                                                          "Pacific/Pago_Pago",
                                                          "Pacific/Palau",
                                                          "Pacific/Pitcairn",
                                                          "Pacific/Pohnpei",
                                                          "Pacific/Ponape",
                                                          "Pacific/Port_Moresby",
                                                          "Pacific/Rarotonga",
                                                          "Pacific/Saipan",
                                                          "Pacific/Samoa",
                                                          "Pacific/Tahiti",
                                                          "Pacific/Tarawa",
                                                          "Pacific/Tongatapu",
                                                          "Pacific/Truk",
                                                          "Pacific/Wake",
                                                          "Pacific/Wallis",
                                                          "Pacific/Yap",
                                                          "Poland",
                                                          "Portugal",
                                                          "PRC",
                                                          "PST8PDT",
                                                          "ROC",
                                                          "ROK",
                                                          "Singapore",
                                                          "Turkey",
                                                          "UCT",
                                                          "Universal",
                                                          "US/Alaska",
                                                          "US/Aleutian",
                                                          "US/Arizona",
                                                          "US/Central",
                                                          "US/Eastern",
                                                          "US/East-Indiana",
                                                          "US/Hawaii",
                                                          "US/Indiana-Starke",
                                                          "US/Michigan",
                                                          "US/Mountain",
                                                          "US/Pacific",
                                                          "US/Pacific-New",
                                                          "US/Samoa",
                                                          "UTC",
                                                          "WET",
                                                          "W-SU",
                                                          "Zulu")),
    
    
    selectInput("hepasessions", "How many HEPA sessions were recorded?",
                list(0,1,2)),
    
    conditionalPanel(
      condition = "input.hepasessions >= 1",
      
      dateInput("HEPA1_date", "Enter the date of the 1st HEPA session"),
      textInput("HEPA1_times", "Enter the start and end times for the 1st HEPA session in this format: (HH:MM/HH:MM). Use 24-hour time (00-23) for the hour." )),
    
    #       textInput("HEPA1_times", "Enter the start and end times for the 1st HEPA session in this format: (YYYY-MM-DD HH:MM/YYYY-MM-DD HH:MM). Use 24-hour time (00-23) for the hour.")),
    #     
    
    conditionalPanel(
      condition = "input.hepasessions == 2",
      dateInput("HEPA2_date", "Enter the date of the 2nd HEPA session"),
      textInput("HEPA2_times", "Enter the start and end times for the 2nd HEPA session in this format: (HH:MM/HH:MM). Use 24-hour time (00-23) for the hour." )),
    
    #       textInput("HEPA2_times", "Enter the start and end times for the 2nd HEPA session in this format: (YYYY-MM-DD HH:MM/YYYY-MM-DD HH:MM). Use 24-hour time (00-23) for the hour.")),
    #     
    
    textInput("window_width", "Enter the number of minutes over which to calculate the rolling mean for compliance (E.G. 10 for regular wear, or 30 for backpack wear)", "10"),
    
    radioButtons("dateformat", "How are dates formatted in the datafile?", 
                 list("dd-mmm-yy" =  "dmy", 
                      "mm/dd/yyyy" = "mdy")),
    
    textInput("dir", "Paste the filepath to the location where you would like to save the output"),
    
    fileInput('file1', 'Choose CSV File from local drive',
              accept=c('text/csv', 'text/comma-separated-values','text/plain')),
    
    actionButton("go", "Process Data"),
    
    helpText("Please note - there may be a delay of up to 1 minute after clicking 'Process Data' as the data is processed.")
  ),
  
  mainPanel(
    tabsetPanel(
      tabPanel("Summary", 
               h4(textOutput("caption1")),
               verbatimTextOutput("summary")), 
      tabPanel("Nephelometer(Min)", 
               h4(textOutput("caption2")),
               plotOutput("minute_nephelometer")), 
      tabPanel("Nephelometer(Hr)", 
               h4(textOutput("caption3")),
               plotOutput("hour_nephelometer")),
      tabPanel("Nephelometer(24h)", 
               h4(textOutput("caption7")),
               plotOutput("nephelometer_24h")),
      tabPanel("Compliance(Min)", 
               h4(textOutput("caption4")),
               plotOutput("compliance")),
      tabPanel("Compliance(24h)", 
               h4(textOutput("caption5")),
               plotOutput("compliance24")),
      tabPanel("RH(Min)",
               h4(textOutput("caption6")),
               plotOutput("RHplot"))
    ))
))
